{% extends "base.html" %}

{% block title %}Hand #{{ hand_data.hand_id }} GTO Analysis{% endblock %}

{% block content %}
<div class="analysis-view">
    <div class="analysis-header">
        <h2>Hand #{{ hand_data.hand_id }} - GTO Analysis</h2>
        <div class="analysis-meta">
            <span class="stakes">{{ hand_data.stakes }}</span>
            <span class="game-type">{{ hand_data.game_type }}</span>
            <span class="deviation-score">Deviation: {{ "%.2f"|format(deviation_score) }}</span>
            <span class="timestamp">{{ processed_at }}</span>
        </div>
    </div>
    
    <div class="ai-trigger-section">
        <button class="btn btn-primary btn-lg trigger-ai" 
                data-hand-id="{{ hand_data.hand_id }}"
                data-deviation="{{ deviation_score }}">
            ğŸ¤– Run AI Analysis for This Hand
        </button>
        <p class="ai-info">Get detailed strategic insights with ChatGPT analysis (~$0.25)</p>
        <div class="ai-status" id="status-{{ hand_data.hand_id }}" style="display: none;">
            <span class="loading">ğŸ”„ Running AI analysis...</span>
        </div>
    </div>
    
    <div class="analysis-content">
        <!-- Hand History Section -->
        <div class="section">
            <h3>ğŸƒ Hand History</h3>
            <div class="hand-history">
                {{ formatted_hand }}
            </div>
        </div>
        
        <!-- GTO+ Solver Results -->
        <div class="section">
            <h3>ğŸ¯ GTO+ Solver Results</h3>
            
            <div class="solver-grid">
                <div class="solver-section">
                    <h4>ğŸ“Š Ranges</h4>
                    <div class="ranges-display">
                        {{ formatted_ranges }}
                    </div>
                </div>
                
                <div class="solver-section">
                    <h4>ğŸ“ˆ Frequencies</h4>
                    <div class="frequencies-display">
                        {{ formatted_frequencies }}
                    </div>
                </div>
                
                <div class="solver-section">
                    <h4>ğŸ’° EV Analysis</h4>
                    <div class="ev-display">
                        {{ formatted_ev }}
                    </div>
                </div>
            </div>
            
            {% if solver_result.processing_time %}
            <div class="processing-info">
                <small>Processing time: {{ "%.2f"|format(solver_result.processing_time) }}s</small>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}